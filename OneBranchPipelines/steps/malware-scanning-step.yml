#################################################################################
# Licensed to the .NET Foundation under one or more agreements.
# The .NET Foundation licenses this file to you under the MIT license.
# See the LICENSE file in the project root for more information.
#################################################################################

# Malware Scanning Step Template
# Scans artifacts for malware before signing/publishing
parameters:
  - name: scanPath
    type: string
    displayName: 'Path to scan for malware'
  
  - name: artifactType
    type: string
    displayName: 'Type of artifact (dll, pkg)'
    values:
      - 'dll'
      - 'pkg'

steps:
  - task: ComponentGovernanceComponentDetection@0
    displayName: 'Component Governance Detection'
    inputs:
      scanType: 'Register'
      verbosity: 'Verbose'
      alertWarningLevel: 'High'
  
  # AntiMalware scanning (OneBranch will inject this automatically via globalSdl)
  # This step is a placeholder for visibility
  - script: |
      echo "Malware scanning for ${{ parameters.artifactType }} files in ${{ parameters.scanPath }}"
      echo "OneBranch AntiMalware scanning will be performed automatically"
    displayName: 'Malware Scan Notification (${{ parameters.artifactType }})'
